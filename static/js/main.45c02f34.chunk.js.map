{"version":3,"sources":["components/data-item.js","components/product/product.js","lib/firebase.js","App.js","reportWebVitals.js","index.js"],"names":["DataItem","dataItem","className","loading","isInStock","alt","src","productPrice","productName","format","Date","date","productSite","rel","target","href","productUrl","key","Product","productData","createProduct","editProduct","deleteProduct","useState","id","name","setName","url","setUrl","site","setSite","type","value","onChange","e","onClick","app","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","getAuth","db","getDatabase","dataRef","ref","stockRef","last50DataRef","query","limitToLast","lastHourInStock","App","data","setData","inStockItems","setInStockItems","products","setProducts","setLoading","loggedIn","setLoggedIn","isAdmin","setIsAdmin","set","productId","remove","useEffect","onChildAdded","productListSnap","newProduct","val","existingProducts","onChildRemoved","filter","p","snapshot","newItems","curData","onChildChanged","copy","findIndex","cd","onAuthStateChanged","user","uid","signOut","provider","GoogleAuthProvider","signInWithRedirect","startAuth","push","map","d","sort","a","b","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.45c02f34.chunk.js","sourcesContent":["import { format } from \"timeago.js\";\r\nimport \"./data-item.scss\"\r\n\r\nexport function DataItem({ dataItem }) {\r\n  return (\r\n    <div className={`dataItem${dataItem.loading ? ' loading' : dataItem.isInStock ? ' inStock' : ' notInStock'}`} key={dataItem.key}>\r\n      <div className=\"leftContent\">\r\n        <header className=\"headerContent\">\r\n          <span>{dataItem.loading ? <img alt=\"\" className=\"loadingSpinner\" src=\"stock-checker-site/loading.svg\" /> : dataItem.productPrice ? dataItem.isInStock ? '‚úîÔ∏è' : '‚ùå' : '‚ùî'}</span>\r\n          <span className=\"name\">{dataItem.productName}</span>\r\n        </header>\r\n        <div className=\"smallContent\">\r\n          <span className=\"timestamp\">{format(new Date(dataItem.date), 'es_ES')}</span>\r\n          <span className=\"site\">- @{dataItem.productSite}</span>\r\n        </div>\r\n      </div>\r\n      <div className=\"rightContent\">\r\n        <span className=\"price\">{dataItem.productPrice ? dataItem.productPrice : dataItem.loading ? <img alt=\"\" className=\"loadingSpinner\" src=\"stock-checker-site/loading.svg\" /> : '‚ùî'} EUR</span>\r\n        <a rel=\"noreferrer\" target=\"_blank\" href={dataItem.productUrl} className=\"visitButton\">üîó Visit</a>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import { useState } from 'react'\r\nimport './product.scss'\r\n\r\nexport function Product({ productData, createProduct, editProduct, deleteProduct }) {\r\n  const [id, setId] = useState(productData?.id)\r\n  const [name, setName] = useState(productData?.name)\r\n  const [url, setUrl] = useState(productData?.url)\r\n  const [site, setSite] = useState(productData?.site)\r\n\r\n  const localCreateProduct = () => {\r\n    createProduct({ name, url, site })\r\n    setName('')\r\n    setUrl('')\r\n    setSite('')\r\n  }\r\n\r\n  return (\r\n    <article className=\"productItem\">\r\n      <ul>\r\n        <li><label>Nombre</label><input type=\"text\" value={name} onChange={e => setName(e.target.value)} /></li>\r\n        <li><label>Web</label><input type=\"text\" value={site} onChange={e => setSite(e.target.value)} /></li>\r\n        <li><label>URL</label><input type=\"text\" value={url} onChange={e => setUrl(e.target.value)} /></li>\r\n      </ul>\r\n      {createProduct ? <button type=\"button\" onClick={() => localCreateProduct()}>Crear</button> : <>\r\n        <button type=\"button\" onClick={() => editProduct({ id, name, url, site })}>Guardar</button>\r\n        <button type=\"button\" onClick={() => deleteProduct(id)}>Eliminar</button>\r\n      </>}\r\n    </article>\r\n  )\r\n}","import { initializeApp } from \"@firebase/app\"\r\nimport { getAuth } from \"@firebase/auth\"\r\nimport { getDatabase } from \"@firebase/database\"\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyD4XxIuiekhE84uh7_IIVX8Fzf3wXYCcDA\",\r\n  authDomain: \"price-tracker-1c428.firebaseapp.com\",\r\n  databaseURL: \"https://price-tracker-1c428.firebaseio.com\",\r\n  projectId: \"price-tracker-1c428\",\r\n  storageBucket: \"price-tracker-1c428.appspot.com\",\r\n  messagingSenderId: \"371469893400\",\r\n  appId: \"1:371469893400:web:661c8956a419487ddc286d\",\r\n  measurementId: \"G-GJBMLVW97M\"\r\n};\r\n\r\nexport const app = initializeApp(firebaseConfig)\r\nexport const auth = getAuth(app)\r\nexport const db = getDatabase(app)","import './reset.scss';\r\nimport './App.scss';\r\n\r\nimport { ref, onChildAdded, onChildChanged, limitToLast, query, push, set, remove, onChildRemoved } from \"firebase/database\";\r\nimport { useEffect, useState } from 'react'\r\nimport { DataItem } from './components/data-item';\r\nimport { signInWithRedirect, GoogleAuthProvider, signOut, onAuthStateChanged } from 'firebase/auth'\r\nimport { Product } from './components/product/product';\r\nimport { auth, db } from './lib/firebase';\r\n\r\n\r\nconst dataRef = ref(db, '/data')\r\nconst stockRef = ref(db, '/latestStock')\r\nconst last50DataRef = query(dataRef, limitToLast(50))\r\nconst lastHourInStock = query(stockRef, limitToLast(50))\r\n\r\nfunction App() {\r\n  const [data, setData] = useState([])\r\n  const [inStockItems, setInStockItems] = useState([])\r\n  const [products, setProducts] = useState([])\r\n  const [loading, setLoading] = useState(false)\r\n  const [loggedIn, setLoggedIn] = useState()\r\n  const [isAdmin, setIsAdmin] = useState(false)\r\n\r\n  const addData = newItems => {\r\n    setData(curData => [...curData, ...newItems])\r\n  }\r\n\r\n  const addInStock = newItems => {\r\n    setInStockItems(curData => [...curData, ...newItems])\r\n  }\r\n\r\n  const replaceData = dataItem => {\r\n    setData(curData => {\r\n      const copy = [...curData]\r\n      copy[copy.findIndex(cd => cd.id === dataItem.id)] = dataItem\r\n      return copy\r\n    })\r\n  }\r\n\r\n  const replaceInStock = dataItem => {\r\n    setInStockItems(curData => {\r\n      const copy = [...curData]\r\n      copy[copy.findIndex(cd => cd.id === dataItem.id)] = dataItem\r\n      return copy\r\n    })\r\n  }\r\n\r\n  const startAuth = () => {\r\n    const provider = new GoogleAuthProvider()\r\n    signInWithRedirect(auth, provider)\r\n  }\r\n\r\n  const createProduct = productData => {\r\n    push(ref(db, '/products'), {\r\n      name: productData.name,\r\n      site: productData.site,\r\n      url: productData.url,\r\n    })\r\n  }\r\n\r\n  const editProduct = productData => {\r\n    set(ref(db, `/products/${productData.id}`), {\r\n      name: productData.name,\r\n      site: productData.site,\r\n      url: productData.url,\r\n    })\r\n  }\r\n\r\n  const deleteProduct = productId => {\r\n    remove(ref(db, `/products/${productId}`))\r\n  }\r\n\r\n  useEffect(() => {\r\n    onChildAdded(query(ref(db, '/products')), productListSnap => {\r\n      const newProduct = {\r\n        id: productListSnap.key,\r\n        ...productListSnap.val(),\r\n      }\r\n      setProducts(existingProducts => [newProduct, ...existingProducts])\r\n    })\r\n    onChildRemoved(query(ref(db, '/products')), productListSnap => {\r\n      setProducts(existingProducts => [...existingProducts.filter(p => p.id !== productListSnap.key)])\r\n    })\r\n    onChildRemoved(query(ref(db, '/latestStock')), productListSnap => {\r\n      setInStockItems(existingProducts => [...existingProducts.filter(p => p.id !== productListSnap.key)])\r\n    })\r\n    setLoading(true)\r\n    onChildAdded(last50DataRef, (snapshot) => {\r\n      const data = {\r\n        id: snapshot.key,\r\n        ...snapshot.val(),\r\n      }\r\n      setLoading(false)\r\n      addData([data])\r\n    })\r\n    onChildAdded(lastHourInStock, (snapshot) => {\r\n      const data = {\r\n        id: snapshot.key,\r\n        ...snapshot.val(),\r\n      }\r\n      addInStock([data])\r\n    })\r\n    onChildChanged(lastHourInStock, (snapshot) => {\r\n      const data = {\r\n        id: snapshot.key,\r\n        ...snapshot.val(),\r\n      }\r\n      replaceInStock(data)\r\n    })\r\n    onChildChanged(last50DataRef, (snapshot) => {\r\n      const data = {\r\n        id: snapshot.key,\r\n        ...snapshot.val(),\r\n      }\r\n      replaceData(data)\r\n    })\r\n    onAuthStateChanged(auth, user => {\r\n      if (user) {\r\n        if (user.uid === \"7Xhp5BspVFNqxngdLYKk5C9Hzm62\") setIsAdmin(true)\r\n        setLoggedIn(true)\r\n      } else {\r\n        setIsAdmin(false)\r\n        setLoggedIn(false)\r\n      }\r\n    })\r\n  }, [])\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      {loggedIn === true ? <button onClick={() => signOut(auth)} type=\"button\">logout</button> : loggedIn === false ? <button onClick={() => startAuth()} type=\"button\">login</button> : 'Checking your session...'}\r\n      {isAdmin &&\r\n        <>\r\n          <h1 className=\"heading\">Productos</h1>\r\n          <h2 className=\"subheading\">Crear producto</h2>\r\n          <div className=\"productList\">\r\n            <Product createProduct={createProduct} />\r\n          </div>\r\n          <h2 className=\"subheading\">Productos actuales</h2>\r\n          <div className=\"productList\">\r\n            {products.map(p => <Product productData={p} editProduct={editProduct} deleteProduct={deleteProduct} key={p.id} />)}\r\n          </div>\r\n        </>\r\n      }\r\n      <h1 className=\"heading\">En stock</h1>\r\n      <div className=\"data\">\r\n        {inStockItems.map(d => ({ ...d, isInStock: true })).map(d => (\r\n          <DataItem dataItem={d} key={d.id} />\r\n        ))}\r\n      </div>\r\n      <h1 className=\"heading\">Informaci√≥n en directo</h1>\r\n      <div className=\"data\">\r\n        {loading ? 'Recuperando datos...' : data.sort((a, b) => a.date > b.date ? -1 : 1).map(d => (\r\n          <DataItem dataItem={d} key={d.id} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}